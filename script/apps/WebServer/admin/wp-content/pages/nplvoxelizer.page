<?npl
--[[
Title: nplvoxelizer page
Author: leio
Date: 2016/10/5
Desc: 
]]

wp_enqueue_script("ace",						"/wp-includes/js/ace/ace.js"); 
wp_enqueue_script("angular",					"/wp-includes/js/angular/angular.min.js");
wp_enqueue_script("ngStorage",					"/wp-includes/js/angular/ngStorage.js");
wp_enqueue_script("ngSanitize",					"/wp-includes/js/angular/angular-sanitize.min.js");
wp_enqueue_script("ui-bootstrap-tpls",			"/wp-includes/js/angular/ui-bootstrap-tpls-1.3.3.min.js");
wp_enqueue_script("bootstrap-css",				"/wp-includes/js/bootstrap/css/bootstrap.min.css");
wp_enqueue_script("bootstrap-css",				"/wp-includes/js/jquery/jquery.min.js");

wp_enqueue_script("nplvoxelizer_app",					"/wp-content/pages/nplvoxelizer/app.js");
wp_enqueue_script("NplVoxelizerController",				"/wp-content/pages/nplvoxelizer/controllers/NplVoxelizerController.js");


NPL.load("(gl)Mod/NplVoxelizer/NplVoxelizerService.lua");
local NplVoxelizerService = commonlib.gettable("Mod.NplVoxelizer.NplVoxelizerService");

local code = request:get("code");
local v = request:get("v");
if(is_ajax()) then
	add_action('wp_ajax_runcode', function()
		local output = CSGService.buildPageContent(code)
		wp_send_json(output,true);
    end)
	return;
end
?>
<div ng-app="nplvoxelizer_app">
	<nplvoxelizer></nplvoxelizer>
</div>